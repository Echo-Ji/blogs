(window.webpackJsonp=window.webpackJsonp||[]).push([[40],{308:function(t,s,a){"use strict";a.r(s);var e=a(5),i=Object(e.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h2",{attrs:{id:"循环神经网络"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#循环神经网络"}},[t._v("#")]),t._v(" 循环神经网络")]),t._v(" "),a("p",[t._v("全称 Recurrent Neural Networks, RNN，它可以应对多对多，多对一，一对一，一对多的任务，其模型可以表示为下图。")]),t._v(" "),a("div",{staticStyle:{"text-align":"center"}},[a("img",{staticStyle:{margin:"0 auto"},attrs:{src:t.$withBase("/2020-09-18-rnn-f.png"),alt:"2020-09-18-rnn-f"}})]),t._v(" "),a("p",[t._v("传统的 RNN 存在一个限制，某一时刻的预测仅使用了前面序列的信息，没有用到后面序列的信息，双向 RNN 可以解决这个问题（BRNN）。")]),t._v(" "),a("p",[t._v("此外，基本的 RNN 存在梯度消失的问题，而且很难捕捉到长期的依赖关系。")]),t._v(" "),a("p",[t._v("于是有了两个变体 GRU 和 LSTM。")]),t._v(" "),a("h3",{attrs:{id:"gru-和-lstm"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#gru-和-lstm"}},[t._v("#")]),t._v(" GRU 和 LSTM")]),t._v(" "),a("p",[t._v("GRU 只有两个门，是更加简单的模型，计算性能上更快，可以创建更大规模的网络。\nLSTM 有三个门，更加强大和灵活，历史更加悠久。")]),t._v(" "),a("h3",{attrs:{id:"深层-rnn"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#深层-rnn"}},[t._v("#")]),t._v(" 深层 RNN")]),t._v(" "),a("p",[t._v("堆叠隐藏层，延迟对 y 的预测。")]),t._v(" "),a("h2",{attrs:{id:"词嵌入"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#词嵌入"}},[t._v("#")]),t._v(" 词嵌入")]),t._v(" "),a("p",[t._v("词嵌入（word embedding）是语言表示的一种方法，区别于 One-hot 表示，它可以让算法自动理解一些类似的词，比如男人对女人，国王对王后。")]),t._v(" "),a("p",[t._v("通过 t-SNE 算法可以将高维数据映射到平面中进行可视化。")]),t._v(" "),a("p",[t._v("一般情况下，自己的任务中数据集较小，需要使用迁移学习来优化性能，使用词嵌入进行迁移学习的流程如下：")]),t._v(" "),a("ul",[a("li",[t._v("从大量文本中学习词嵌入（或者下载预训练词嵌入模型）")]),t._v(" "),a("li",[t._v("迁移到只有少量标注数据的任务中来")]),t._v(" "),a("li",[t._v("此外，可以选择对词嵌入模型进行 finetune")])]),t._v(" "),a("p",[t._v("词嵌入可以帮助我们进行类比推理，比如 "),a("code",[t._v("男人 - 女人 = 国王 - ?")]),t._v("，通过词嵌入，可以得到 "),a("code",[t._v("? = 王后")]),t._v("。\n那么如何得到有效的词嵌入呢？")]),t._v(" "),a("h3",{attrs:{id:"学习词嵌入矩阵"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#学习词嵌入矩阵"}},[t._v("#")]),t._v(" 学习词嵌入矩阵")]),t._v(" "),a("p",[t._v("词嵌入向量通常会被构造成词嵌入矩阵 "),a("span",{staticClass:"katex"},[a("span",{staticClass:"katex-mathml"},[a("math",[a("semantics",[a("mrow",[a("mi",[t._v("E")])],1),a("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("E")])],1)],1)],1),a("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[a("span",{staticClass:"strut",staticStyle:{height:"0.68333em"}}),a("span",{staticClass:"strut bottom",staticStyle:{height:"0.68333em","vertical-align":"0em"}}),a("span",{staticClass:"base textstyle uncramped"},[a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.05764em"}},[t._v("E")])])])]),t._v("，每列为一个词向量 "),a("span",{staticClass:"katex"},[a("span",{staticClass:"katex-mathml"},[a("math",[a("semantics",[a("mrow",[a("msub",[a("mi",[t._v("e")]),a("mi",[t._v("x")])],1)],1),a("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("e_x")])],1)],1)],1),a("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[a("span",{staticClass:"strut",staticStyle:{height:"0.43056em"}}),a("span",{staticClass:"strut bottom",staticStyle:{height:"0.58056em","vertical-align":"-0.15em"}}),a("span",{staticClass:"base textstyle uncramped"},[a("span",{staticClass:"mord"},[a("span",{staticClass:"mord mathit"},[t._v("e")]),a("span",{staticClass:"vlist"},[a("span",{staticStyle:{top:"0.15em","margin-right":"0.05em","margin-left":"0em"}},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),a("span",{staticClass:"reset-textstyle scriptstyle cramped"},[a("span",{staticClass:"mord mathit"},[t._v("x")])])]),a("span",{staticClass:"baseline-fix"},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),t._v("​")])])])])])]),t._v("。")]),t._v(" "),a("p",[t._v("可以通过 "),a("span",{staticClass:"katex"},[a("span",{staticClass:"katex-mathml"},[a("math",[a("semantics",[a("mrow",[a("mi",[t._v("E")])],1),a("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("E")])],1)],1)],1),a("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[a("span",{staticClass:"strut",staticStyle:{height:"0.68333em"}}),a("span",{staticClass:"strut bottom",staticStyle:{height:"0.68333em","vertical-align":"0em"}}),a("span",{staticClass:"base textstyle uncramped"},[a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.05764em"}},[t._v("E")])])])]),t._v(" 与该词的 One-hot 编码 "),a("span",{staticClass:"katex"},[a("span",{staticClass:"katex-mathml"},[a("math",[a("semantics",[a("mrow",[a("msub",[a("mi",[t._v("o")]),a("mi",[t._v("x")])],1)],1),a("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("o_x")])],1)],1)],1),a("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[a("span",{staticClass:"strut",staticStyle:{height:"0.43056em"}}),a("span",{staticClass:"strut bottom",staticStyle:{height:"0.58056em","vertical-align":"-0.15em"}}),a("span",{staticClass:"base textstyle uncramped"},[a("span",{staticClass:"mord"},[a("span",{staticClass:"mord mathit"},[t._v("o")]),a("span",{staticClass:"vlist"},[a("span",{staticStyle:{top:"0.15em","margin-right":"0.05em","margin-left":"0em"}},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),a("span",{staticClass:"reset-textstyle scriptstyle cramped"},[a("span",{staticClass:"mord mathit"},[t._v("x")])])]),a("span",{staticClass:"baseline-fix"},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),t._v("​")])])])])])]),t._v(" 得到 "),a("span",{staticClass:"katex"},[a("span",{staticClass:"katex-mathml"},[a("math",[a("semantics",[a("mrow",[a("msub",[a("mi",[t._v("e")]),a("mi",[t._v("x")])],1)],1),a("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("e_x")])],1)],1)],1),a("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[a("span",{staticClass:"strut",staticStyle:{height:"0.43056em"}}),a("span",{staticClass:"strut bottom",staticStyle:{height:"0.58056em","vertical-align":"-0.15em"}}),a("span",{staticClass:"base textstyle uncramped"},[a("span",{staticClass:"mord"},[a("span",{staticClass:"mord mathit"},[t._v("e")]),a("span",{staticClass:"vlist"},[a("span",{staticStyle:{top:"0.15em","margin-right":"0.05em","margin-left":"0em"}},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),a("span",{staticClass:"reset-textstyle scriptstyle cramped"},[a("span",{staticClass:"mord mathit"},[t._v("x")])])]),a("span",{staticClass:"baseline-fix"},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),t._v("​")])])])])])]),t._v("，即 "),a("span",{staticClass:"katex"},[a("span",{staticClass:"katex-mathml"},[a("math",[a("semantics",[a("mrow",[a("msub",[a("mi",[t._v("e")]),a("mi",[t._v("x")])],1),a("mo",[t._v("=")]),a("mi",[t._v("E")]),a("mo",[t._v("⋅")]),a("msub",[a("mi",[t._v("o")]),a("mi",[t._v("x")])],1)],1),a("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("e_x = E \\cdot o_x")])],1)],1)],1),a("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[a("span",{staticClass:"strut",staticStyle:{height:"0.68333em"}}),a("span",{staticClass:"strut bottom",staticStyle:{height:"0.83333em","vertical-align":"-0.15em"}}),a("span",{staticClass:"base textstyle uncramped"},[a("span",{staticClass:"mord"},[a("span",{staticClass:"mord mathit"},[t._v("e")]),a("span",{staticClass:"vlist"},[a("span",{staticStyle:{top:"0.15em","margin-right":"0.05em","margin-left":"0em"}},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),a("span",{staticClass:"reset-textstyle scriptstyle cramped"},[a("span",{staticClass:"mord mathit"},[t._v("x")])])]),a("span",{staticClass:"baseline-fix"},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),t._v("​")])])]),a("span",{staticClass:"mrel"},[t._v("=")]),a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.05764em"}},[t._v("E")]),a("span",{staticClass:"mbin"},[t._v("⋅")]),a("span",{staticClass:"mord"},[a("span",{staticClass:"mord mathit"},[t._v("o")]),a("span",{staticClass:"vlist"},[a("span",{staticStyle:{top:"0.15em","margin-right":"0.05em","margin-left":"0em"}},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),a("span",{staticClass:"reset-textstyle scriptstyle cramped"},[a("span",{staticClass:"mord mathit"},[t._v("x")])])]),a("span",{staticClass:"baseline-fix"},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),t._v("​")])])])])])]),t._v("。\n通常以语言模型为载体进行词嵌入的学习，给定多个词预测一个目标词，让给定的词通过 "),a("span",{staticClass:"katex"},[a("span",{staticClass:"katex-mathml"},[a("math",[a("semantics",[a("mrow",[a("msub",[a("mi",[t._v("e")]),a("mi",[t._v("x")])],1),a("mo",[t._v("=")]),a("mi",[t._v("E")]),a("mo",[t._v("⋅")]),a("msub",[a("mi",[t._v("o")]),a("mi",[t._v("x")])],1)],1),a("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("e_x = E \\cdot o_x")])],1)],1)],1),a("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[a("span",{staticClass:"strut",staticStyle:{height:"0.68333em"}}),a("span",{staticClass:"strut bottom",staticStyle:{height:"0.83333em","vertical-align":"-0.15em"}}),a("span",{staticClass:"base textstyle uncramped"},[a("span",{staticClass:"mord"},[a("span",{staticClass:"mord mathit"},[t._v("e")]),a("span",{staticClass:"vlist"},[a("span",{staticStyle:{top:"0.15em","margin-right":"0.05em","margin-left":"0em"}},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),a("span",{staticClass:"reset-textstyle scriptstyle cramped"},[a("span",{staticClass:"mord mathit"},[t._v("x")])])]),a("span",{staticClass:"baseline-fix"},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),t._v("​")])])]),a("span",{staticClass:"mrel"},[t._v("=")]),a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.05764em"}},[t._v("E")]),a("span",{staticClass:"mbin"},[t._v("⋅")]),a("span",{staticClass:"mord"},[a("span",{staticClass:"mord mathit"},[t._v("o")]),a("span",{staticClass:"vlist"},[a("span",{staticStyle:{top:"0.15em","margin-right":"0.05em","margin-left":"0em"}},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),a("span",{staticClass:"reset-textstyle scriptstyle cramped"},[a("span",{staticClass:"mord mathit"},[t._v("x")])])]),a("span",{staticClass:"baseline-fix"},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),t._v("​")])])])])])]),t._v(" 转化为词向量，然后输入到神经网络（比如 "),a("code",[t._v("Softmax")]),t._v(" 分类器）中预测目标词，进而优化词嵌入矩阵 "),a("span",{staticClass:"katex"},[a("span",{staticClass:"katex-mathml"},[a("math",[a("semantics",[a("mrow",[a("mi",[t._v("E")])],1),a("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("E")])],1)],1)],1),a("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[a("span",{staticClass:"strut",staticStyle:{height:"0.68333em"}}),a("span",{staticClass:"strut bottom",staticStyle:{height:"0.68333em","vertical-align":"0em"}}),a("span",{staticClass:"base textstyle uncramped"},[a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.05764em"}},[t._v("E")])])])]),t._v("。如下图所示（图片来自于 Andrew Ng）。")]),t._v(" "),a("div",{staticStyle:{"text-align":"center"}},[a("img",{staticStyle:{margin:"0 auto"},attrs:{src:t.$withBase("/2020-09-18-lang-model.png"),alt:"2020-10-13-lang-model"}})]),t._v(" "),a("p",[t._v("给定的多个词可以是目标词的上下文中的任意词，比如前 4 个，前后 4 个，前一个或者 5-邻域内任意一个词等。")]),t._v(" "),a("h4",{attrs:{id:"word2vec"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#word2vec"}},[t._v("#")]),t._v(" Word2Vec")]),t._v(" "),a("p",[t._v("Word2Vec 有两种很常见的方式：Skip-Gram 模型和连续词袋（CBOW）模型。")]),t._v(" "),a("p",[t._v("其主要还是基于前文的方法构建 "),a("code",[t._v("Softmax")]),t._v(" 分类器，但是局限在于当 "),a("code",[t._v("Softmax")]),t._v(" 类别多的时候计算速度很慢，因此想要扩大词汇表就更加困难了。")]),t._v(" "),a("p",[t._v("解决方案有两种：分级 "),a("code",[t._v("Softmax")]),t._v(" 分类器和负采样。")]),t._v(" "),a("ul",[a("li",[t._v("分级 "),a("code",[t._v("Softmax")]),t._v(" 分类器将构建树状的二分类器，使得计算成本与词汇表的对数成正比")]),t._v(" "),a("li",[t._v("负采样则对每一对 "),a("code",[t._v("上下文-目标词")]),t._v(" 构建 "),a("span",{staticClass:"katex"},[a("span",{staticClass:"katex-mathml"},[a("math",[a("semantics",[a("mrow",[a("mi",[t._v("K")])],1),a("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("K")])],1)],1)],1),a("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[a("span",{staticClass:"strut",staticStyle:{height:"0.68333em"}}),a("span",{staticClass:"strut bottom",staticStyle:{height:"0.68333em","vertical-align":"0em"}}),a("span",{staticClass:"base textstyle uncramped"},[a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.07153em"}},[t._v("K")])])])]),t._v(" 个负样本，每次只训练 "),a("span",{staticClass:"katex"},[a("span",{staticClass:"katex-mathml"},[a("math",[a("semantics",[a("mrow",[a("mi",[t._v("K")]),a("mo",[t._v("+")]),a("mn",[t._v("1")])],1),a("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("K+1")])],1)],1)],1),a("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[a("span",{staticClass:"strut",staticStyle:{height:"0.68333em"}}),a("span",{staticClass:"strut bottom",staticStyle:{height:"0.76666em","vertical-align":"-0.08333em"}}),a("span",{staticClass:"base textstyle uncramped"},[a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.07153em"}},[t._v("K")]),a("span",{staticClass:"mbin"},[t._v("+")]),a("span",{staticClass:"mord mathrm"},[t._v("1")])])])]),t._v(" 个二分类器，使得计算成本成为常数")])]),t._v(" "),a("p",[t._v("此外，GloVe 算法也是一种计算词嵌入的方法。")])])}),[],!1,null,null,null);s.default=i.exports}}]);