<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>聚类算法 | Echo Ji</title>
    <meta name="description" content=" 面试前整理的一些自己不熟悉的知识点，好想拥有一个硬盘一样的脑袋，可以不忘掉的那种。 --&gt;
基于距离
K-means 是基于距离的聚类方法的代表，这类方法的聚类结果都是球状的簇，当数据中存在非球状结构时，其效果并不好。
K-means 适用条件
但 K-means 算法简单有效，其适用条件为：
空间中存在距离度量 ``，且满 ...">
    <link rel="icon" href="/blogs/favicon.ico">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.7.1/katex.min.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/github-markdown-css/2.10.0/github-markdown.min.css">
    
    <link rel="preload" href="/blogs/assets/css/0.styles.606e9f23.css" as="style"><link rel="preload" href="/blogs/assets/js/app.67f6c0ad.js" as="script"><link rel="preload" href="/blogs/assets/js/4.7c2c95e9.js" as="script"><link rel="preload" href="/blogs/assets/js/5.8b86248a.js" as="script"><link rel="preload" href="/blogs/assets/js/33.015d00b6.js" as="script"><link rel="prefetch" href="/blogs/assets/js/1.e76662eb.js"><link rel="prefetch" href="/blogs/assets/js/10.c6aeaa4b.js"><link rel="prefetch" href="/blogs/assets/js/11.82df316d.js"><link rel="prefetch" href="/blogs/assets/js/12.eab284d2.js"><link rel="prefetch" href="/blogs/assets/js/13.cd8e489a.js"><link rel="prefetch" href="/blogs/assets/js/14.a3f84c0c.js"><link rel="prefetch" href="/blogs/assets/js/15.9bdbb339.js"><link rel="prefetch" href="/blogs/assets/js/16.f4317575.js"><link rel="prefetch" href="/blogs/assets/js/17.fa69ee94.js"><link rel="prefetch" href="/blogs/assets/js/18.d453431b.js"><link rel="prefetch" href="/blogs/assets/js/19.064e46d1.js"><link rel="prefetch" href="/blogs/assets/js/20.c1c3c0e8.js"><link rel="prefetch" href="/blogs/assets/js/21.04422038.js"><link rel="prefetch" href="/blogs/assets/js/22.513643ab.js"><link rel="prefetch" href="/blogs/assets/js/23.c151a0a2.js"><link rel="prefetch" href="/blogs/assets/js/24.2308ffa1.js"><link rel="prefetch" href="/blogs/assets/js/25.ead0a5d4.js"><link rel="prefetch" href="/blogs/assets/js/26.0ef4d587.js"><link rel="prefetch" href="/blogs/assets/js/27.f8f8a9f8.js"><link rel="prefetch" href="/blogs/assets/js/28.f37568cf.js"><link rel="prefetch" href="/blogs/assets/js/29.cc7c7c41.js"><link rel="prefetch" href="/blogs/assets/js/30.61a41790.js"><link rel="prefetch" href="/blogs/assets/js/31.4f93a2f0.js"><link rel="prefetch" href="/blogs/assets/js/32.3007c773.js"><link rel="prefetch" href="/blogs/assets/js/34.5b8ce30c.js"><link rel="prefetch" href="/blogs/assets/js/35.2c376d79.js"><link rel="prefetch" href="/blogs/assets/js/36.68b803bc.js"><link rel="prefetch" href="/blogs/assets/js/37.61275c14.js"><link rel="prefetch" href="/blogs/assets/js/38.e3e5c80e.js"><link rel="prefetch" href="/blogs/assets/js/39.d17125e0.js"><link rel="prefetch" href="/blogs/assets/js/40.00614145.js"><link rel="prefetch" href="/blogs/assets/js/41.dc745971.js"><link rel="prefetch" href="/blogs/assets/js/42.792f151c.js"><link rel="prefetch" href="/blogs/assets/js/43.e40bff08.js"><link rel="prefetch" href="/blogs/assets/js/6.0217efa2.js"><link rel="prefetch" href="/blogs/assets/js/7.c3500f45.js"><link rel="prefetch" href="/blogs/assets/js/8.dc8dfe73.js"><link rel="prefetch" href="/blogs/assets/js/9.119b9b2f.js"><link rel="prefetch" href="/blogs/assets/js/vuejs-paginate.e1db4a3b.js">
    <link rel="stylesheet" href="/blogs/assets/css/0.styles.606e9f23.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div id="vuepress-theme-blog__global-layout"><section id="header-wrapper"><header id="header"><div class="header-wrapper"><div class="title"><a href="/blogs/" class="nav-link home-link">Echo Ji </a></div> <div class="header-right-wrap"><ul class="nav"><li class="nav-item"><a href="/blogs/" class="nav-link">Blog</a></li><li class="nav-item"><a href="/blogs/tag/" class="nav-link">Tags</a></li></ul> <div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <!----></div></div></header></section> <div id="mobile-header"><div class="mobile-header-bar"><div class="mobile-header-title"><a href="/blogs/" class="nav-link mobile-home-link">Echo Ji </a> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"><line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line></svg></div> <div class="mobile-menu-wrapper"><hr class="menu-divider"> <ul class="mobile-nav"><li class="mobile-nav-item"><a href="/blogs/" class="nav-link">Blog</a></li><li class="mobile-nav-item"><a href="/blogs/tag/" class="nav-link">Tags</a></li> <li class="mobile-nav-item"><!----></li></ul></div></div></div> <div class="content-wrapper"><div id="vuepress-theme-blog__post-layout"><div class="vuepress-blog-theme-content"><h1 class="post-title">聚类算法</h1> <div class="post-meta"><div class="post-meta-author"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-navigation"><polygon points="3 11 22 2 13 21 11 13 3 11"></polygon></svg> Echo
    <span>   in Beijing</span></div> <div class="post-meta-date"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-clock"><circle cx="12" cy="12" r="10"></circle><polyline points="12 6 12 12 16 14"></polyline></svg> 2020-09-07
  </div> <ul class="post-meta-tags"><li class="post-tag" data-v-d832e844><a href="/blogs/tag/机器学习" data-v-d832e844> 机器学习 </a></li><li class="post-tag" data-v-d832e844><a href="/blogs/tag/数据挖掘" data-v-d832e844> 数据挖掘 </a></li><li class="post-tag" data-v-d832e844><a href="/blogs/tag/聚类" data-v-d832e844> 聚类 </a></li></ul></div> <div class="content__default"><h2 id="基于距离"><a href="#基于距离" class="header-anchor">#</a> 基于距离</h2> <p>K-means 是基于距离的聚类方法的代表，这类方法的聚类结果都是球状的簇，当数据中存在非球状结构时，其效果并不好。</p> <h3 id="k-means-适用条件"><a href="#k-means-适用条件" class="header-anchor">#</a> K-means 适用条件</h3> <p>但 K-means 算法简单有效，其适用条件为：</p> <ul><li>空间中存在距离度量 <code>&lt;a, b&gt;</code>，且满足 <code>&lt;a, b&gt; = &lt;b, a&gt;</code></li> <li>存在求中心点的算法</li></ul> <p>比如瑞士卷图就不满足这样的条件，因此不适合使用 K-means 算法。</p> <h3 id="k-means-改进算法"><a href="#k-means-改进算法" class="header-anchor">#</a> K-means 改进算法</h3> <p>针对 K-means 算法有很多改进，比如 优化初始化类中心的 K-means ++，动态调整类个数的 ISODATA，避免陷入局部最优的二分 K-means，解决海量数据聚类的 Mini-Batch K-means 等。</p> <p>这里简单说一下 K-means ++。该算法改进了 K-means 算法的初始化类中心的过程，使得一开始的类中心能够尽可能地分散。具体方法是：</p> <ul><li><p>计算每一个样本点 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.43056em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit">x</span></span></span></span> 到已有的类中心的最短距离 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>D</mi><mo>(</mo><mi>x</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">D(x)</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.02778em;">D</span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mclose">)</span></span></span></span></p></li> <li><p>计算每个样本点被选为下一个类中心的概率 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mfrac><mrow><mi>D</mi><mo>(</mo><mi>x</mi><msup><mo>)</mo><mn>2</mn></msup></mrow><mrow><msub><mo>∑</mo><mrow><mi>x</mi><mo>∈</mo><mi>X</mi></mrow></msub><mi>D</mi><mo>(</mo><mi>x</mi><msup><mo>)</mo><mn>2</mn></msup></mrow></mfrac></mrow><annotation encoding="application/x-tex">\frac{D(x)^2}{\sum_{x \in X} D(x)^2}</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="strut" style="height:1.06132em;"></span><span class="strut bottom" style="height:1.635877em;vertical-align:-0.574557em;"></span><span class="base textstyle uncramped"><span class="mord reset-textstyle textstyle uncramped"><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.345em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mop"><span class="op-symbol small-op mop" style="top:0.074995em;">∑</span><span class="vlist"><span style="top:0.30001em;margin-right:0.07142857142857144em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-scriptstyle scriptscriptstyle cramped"><span class="mord scriptscriptstyle cramped"><span class="mord mathit">x</span><span class="mrel">∈</span><span class="mord mathit" style="margin-right:0.07847em;">X</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mord mathit" style="margin-right:0.02778em;">D</span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mclose"><span class="mclose">)</span><span class="vlist"><span style="top:-0.289em;margin-right:0.07142857142857144em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-scriptstyle scriptscriptstyle cramped"><span class="mord mathrm">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.485em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathit" style="margin-right:0.02778em;">D</span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mclose"><span class="mclose">)</span><span class="vlist"><span style="top:-0.363em;margin-right:0.07142857142857144em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-scriptstyle scriptscriptstyle uncramped"><span class="mord mathrm">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span></span></span></span></p></li> <li><p>按样本顺序求概率累加和，按照轮盘法选择出下一个类中心</p></li></ul> <h2 id="基于密度"><a href="#基于密度" class="header-anchor">#</a> 基于密度</h2> <p>与基于距离的聚类算法不同的是，基于密度的聚类算法可以发现任意形状的聚类，DBSCAN 便是这类方法的一个代表。</p> <h3 id="dbscan-算法"><a href="#dbscan-算法" class="header-anchor">#</a> DBSCAN 算法</h3> <p>DBSCAN 算法的基本思想是寻找被低密度区域分离的高密度区域，作为一个“簇”。其中“簇”的定义为：由密度可达关系导出的最大密度相连样本的集合。</p> <h3 id="dbscan-与-k-means-对比"><a href="#dbscan-与-k-means-对比" class="header-anchor">#</a> DBSCAN 与 K-means 对比</h3> <table><thead><tr><th></th> <th>K-means</th> <th>DBSCAN</th></tr></thead> <tbody><tr><td>数据集</td> <td>只适用于凸样本集，聚类结果为球状簇</td> <td>对样本集无要求，可以发现任意形状的簇，但当聚类密度不均匀时，聚类质量较差</td></tr> <tr><td>初始化</td> <td>需要预先声明聚类个数，且初始值对结果影响较大</td> <td>不需要预先声明聚类个数，聚类结果没有偏倚</td></tr> <tr><td>异常值</td> <td>对异常值较为敏感</td> <td>对异常值不敏感</td></tr> <tr><td>海量数据</td> <td>考虑 mini-batch K-means</td> <td>建立 KD 树搜索最近邻</td></tr></tbody></table> <h2 id="谱聚类"><a href="#谱聚类" class="header-anchor">#</a> 谱聚类</h2> <p>谱聚类是广泛使用的聚类算法，比起传统的 K-means，谱聚类对数据分布的适应性更强，聚类效果也更优秀，同时计算量也小很多，实现起来也不复杂。</p> <p>谱聚类的思想是将原始样本点看作图中的节点，用顶点间的相似度度量作为边的权重，构造相似度矩阵，从而将聚类问题转化为图划分问题。而基于图论的最优划分准则就是使划分得到的子图内部相似度最大，子图之间相似度最小。</p> <p>其实说白了就是构建相似矩阵，子图划分（用 Laplace 矩阵求解特征向量），聚类划分数据簇，而这三部分别最常用的是基于高斯核的全连接方式，基于权重的 Ncut 切图以及 K-means 聚类。</p> <p>但是谱聚类非常依赖于相似矩阵的构建，因此不同的距离度量对最终的聚类效果影响很大。</p> <p>参考 <a href="https://zhuanlan.zhihu.com/p/29849122" target="_blank" rel="noopener noreferrer">1<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>。</p> <h2 id="模型聚类"><a href="#模型聚类" class="header-anchor">#</a> 模型聚类</h2> <p>代表为 GMM 模型，它是一个生成模型，该模型试图找到多为高斯模型概率分布的混合表示，从而拟合出任意形状的分布。</p> <p>它使用 EM 算法进行迭代，而且给出的聚类结果是软聚类，即每一个样本只给出属于每一类的概率，同时在模型运行结束后，还可以用于生成新的样本。这些特性使得 GMM 在风控领域非常受欢迎。</p> <h2 id="层次聚类"><a href="#层次聚类" class="header-anchor">#</a> 层次聚类</h2> <p>层次聚类分为自顶向下和自底向上两种方式，也叫分裂和凝聚。自顶向下是将单个连通网络不断划分，直到每个分支只有单个节点为止，自底向上则相反。</p> <p>其分裂（凝聚）依据的差异产生了不同的算法，层次分裂的代表是用于社区发现的 GN 算法，而层次凝聚的代表是 AGNES 算法。</p> <p>可以看到，层次聚类的局限之处在于较高的时间复杂度，因为每更新一步，所有的簇都需要重新计算度量。</p> <p>最后，附上一张各种聚类的效果图 👏。</p> <div style="text-align:center;"><img src="/blogs/2020-09-07-cluster.jpeg" alt="2020-09-07-clst" style="margin:0 auto;"></div></div> <!----> <hr> <!----></div> <div class="sticker vuepress-toc"><div class="vuepress-toc-item vuepress-toc-h2 active"><a href="#基于距离" title="基于距离">基于距离</a></div><div class="vuepress-toc-item vuepress-toc-h3"><a href="#k-means-适用条件" title="K-means 适用条件">K-means 适用条件</a></div><div class="vuepress-toc-item vuepress-toc-h3"><a href="#k-means-改进算法" title="K-means 改进算法">K-means 改进算法</a></div><div class="vuepress-toc-item vuepress-toc-h2"><a href="#基于密度" title="基于密度">基于密度</a></div><div class="vuepress-toc-item vuepress-toc-h3"><a href="#dbscan-算法" title="DBSCAN 算法">DBSCAN 算法</a></div><div class="vuepress-toc-item vuepress-toc-h3"><a href="#dbscan-与-k-means-对比" title="DBSCAN 与 K-means 对比">DBSCAN 与 K-means 对比</a></div><div class="vuepress-toc-item vuepress-toc-h2"><a href="#谱聚类" title="谱聚类">谱聚类</a></div><div class="vuepress-toc-item vuepress-toc-h2"><a href="#模型聚类" title="模型聚类">模型聚类</a></div><div class="vuepress-toc-item vuepress-toc-h2"><a href="#层次聚类" title="层次聚类">层次聚类</a></div></div></div></div> <footer class="footer" data-v-582f9766><div class="footer-left-wrap" data-v-582f9766><ul class="contact" data-v-582f9766><li class="contact-item" data-v-582f9766><a href="https://github.com/Echo-Ji" target="_blank" rel="noopener noreferrer" class="nav-link external" data-v-582f9766><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-github" data-v-582f9766><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22" data-v-582f9766></path></svg>
          
        </a></li><li class="contact-item" data-v-582f9766><a href="/blogs/2020/09/07/%E8%81%9A%E7%B1%BB%E7%AE%97%E6%B3%95/bh1506jjh@gmail.com.html" class="nav-link" data-v-582f9766><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-mail" data-v-582f9766><path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z" data-v-582f9766></path><polyline points="22,6 12,13 2,6" data-v-582f9766></polyline></svg>
          
        </a></li></ul></div> <div class="footer-right-wrap" data-v-582f9766><ul class="copyright" data-v-582f9766><li class="copyright-item" data-v-582f9766><a href="https://github.com/Echo-Ji" target="_blank" rel="noopener noreferrer" class="nav-link external" data-v-582f9766>Echo Ji © 2020</a></li></ul></div></footer></div><div class="global-ui"></div></div>
    <script src="/blogs/assets/js/app.67f6c0ad.js" defer></script><script src="/blogs/assets/js/4.7c2c95e9.js" defer></script><script src="/blogs/assets/js/5.8b86248a.js" defer></script><script src="/blogs/assets/js/33.015d00b6.js" defer></script>
  </body>
</html>
